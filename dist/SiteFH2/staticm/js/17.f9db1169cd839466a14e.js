webpackJsonp([17],{373:function(e,t,s){var i=s(0)(s(733),null,null,null);e.exports=i.exports},386:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"ComAccountBasicNav"}},387:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"ComAccountBody"}},389:function(e,t){},390:function(e,t){},391:function(e,t){},394:function(e,t,s){s(389);var i=s(0)(s(386),s(397),"data-v-260251c6",null);e.exports=i.exports},395:function(e,t,s){s(390),s(391);var i=s(0)(s(387),s(398),"data-v-e6c6c67e",null);e.exports=i.exports},397:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("ul",{staticClass:"basic-nav clearfix"},[e._t("default")],2)},staticRenderFns:[]}},398:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"com-account-body clearfix"},[e._t("default")],2)},staticRenderFns:[]}},414:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(112),a=s.n(i);t.default={name:"ComAccountSubNavEditProfile",components:{modAccountSubNav:a.a}}},481:function(e,t,s){var i=s(0)(s(414),s(490),null,null);e.exports=i.exports},490:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("mod-account-sub-nav",[s("router-link",{attrs:{to:"/account/edit-profile",tag:"li"}},[s("a",[e._v(e._s(e.$labels.accountEditProfile))])]),e._v(" "),s("router-link",{attrs:{to:"/account/edit-password",tag:"li"}},[s("a",[e._v(e._s(e.$labels.accountEditPassword))])]),e._v(" "),s("router-link",{attrs:{to:"/account/edit-secure-question",tag:"li"}},[s("a",[e._v(e._s(e.$labels.accountEditSecureQuestion))])])],1)},staticRenderFns:[]}},675:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(48),a=s.n(i),r=s(6),n=s(481),u=s.n(n),o=s(394),l=s.n(o),c=s(395),m=s.n(c);t.default={name:"PageAccountEditProfile",computed:{userId:function(){return this.$store.state.user.userId},userName:function(){return this.$store.state.user.userName},mobile:function(){return this.$store.state.user.mobile},nickName:function(){return this.$store.state.user.nickName},introducerId:function(){return this.$store.state.user.introducerId},qq:function(){return this.$store.state.user.qq},hasQQ:function(){return!!this.$store.state.user.qq},email:function(){return this.$store.state.user.email}},data:function(){return{canEditMobile:!1,canEditName:!1,canEditUserName:!0,user:{qq:this.qq,email:this.email,user_name:this.userName,real_name:this.nickName,mobile:this.mobile},isPC:0}},created:function(){this.$store.commit("setPage",{pageTitle:this.$labels.accountEditProfile,className:"page-account-edit-profile"}),this.fetchProfile()},methods:{setUser:function(e){return this.$store.commit("uSetUser",e)},fetchUserDetailInfo:function(){return this.$store.dispatch("uFetchUserDetailInfo")},fetchBankInfo:function(){return this.$store.dispatch("uFetchBankInfo")},fetchProfile:function(){var e=this;a.a.all([this.fetchUserDetailInfo(),this.fetchBankInfo()]).then(function(t){e.user.qq=e.qq,e.user.email=e.email,e.user.user_name=e.userName,e.user.real_name=e.nickName,e.user.mobile=e.mobile,e.canEditMobile=!e.mobile,e.canEditName=!t[0].RealName}).catch(function(t){console.log(t),e.$message({message:"获取用户详细信息出错啦！",type:"error",force:!0})})},validateUserName:function(){return""===this.user.user_name?(this.$message({message:"用户名不能为空!",type:"warning"}),!1):/^[a-zA-Z0-9]+$/.test(this.user.user_name)?this.user.user_name.length>20||this.user.user_name.length<2?(this.$message({message:"用户名长度必须在2-20个字符！",type:"warning"}),!1):!(/^\d+$/.test(this.user.user_name)&&!/^1[3-9]\d{9}$/.test(this.user.user_name))||(this.$message({message:"纯数字用户名必须为11位手机号！",type:"warning"}),!1):(this.$message({message:"用户名只能是数字、字母组合！",type:"warning"}),!1)},validators:function(){if(!1===this.validateUserName())return!1;if(this.canEditMobile&&!1===this.validateMobile())return!1;if(""===this.user.real_name)return this.$message({message:"姓名不能为空!",type:"warning"}),!1;if(this.user.real_name.length>16||this.user.real_name.length<2)return this.$message({message:"姓名长度必须在2-16个中文字！",type:"warning"}),!1;if(!/^[\u4e00-\u9fa5]+[·]?[\u4e00-\u9fa5]+[0-9]*$/.test(this.user.real_name))return this.$message({message:"姓名只能是中文和数字！",type:"warning"}),!1;if(!this.isPC){if(!this.hasQQ){if(""===this.user.qq)return this.$message({message:"QQ不能为空!"}),!1;if(/[^\d]/g.test(this.user.qq))return this.$message({message:"QQ只能是数字！"}),!1;if(this.user.qq.length>15||this.user.qq.length<5)return this.$message({message:"标准QQ长度为5-15个数字！"}),!1;if(!/^[1-9][0-9]+$/.test(this.user.qq))return this.$message({message:"QQ格式不正确！"}),!1}if(""!==this.user.email&&!/^\w[\w\.\-]*\w*@\w[\w\.\-]*\w*\.[a-zA-Z]+$/.test(this.user.email))return this.$message({message:"邮箱格式不正确！"}),!1}return!0},validateMobile:function(){return""===this.user.mobile?(this.$message({message:"手机号码不能为空!",type:"warning"}),!1):/[^\d]/g.test(this.user.mobile)?(this.$message({message:"手机号码只能是数字组成！",type:"warning"}),!1):/^1[3-9]\d+$/.test(this.user.mobile)?11===this.user.mobile.length||(this.$message({message:"手机号码必须是11位标准号码！",type:"warning"}),!1):(this.$message({message:"手机号码无效！",type:"warning"}),!1)},saveProfile:function(){var e=this;!1!==this.validators()&&r.apiUpdateUserDetailInfo({QQ:this.user.qq,Email:this.user.email,UserName:this.user.user_name,real_name:this.user.real_name,mobile:this.canEditMobile?this.user.mobile:void 0,t:this.isPC?1:void 0}).then(function(e){return e.json()}).then(function(t){"762"===t.S||"900"===t.S?(e.$message({message:"修改资料成功！",type:"success",time:1e3,afterClose:function(){"900"===t.S&&window.location.reload()}}),e.setUser({qq:e.user.qq,email:e.user.email,userName:e.user.user_name,nickName:e.user.real_name}),e.user.mobile&&(e.canEditMobile=!1)):e.$message({message:t.S+": "+t.D,type:"error"})}).catch(function(t){console.log(t),e.$message({message:"修改资料出错啦！",type:"error",force:!0})})}},components:{modAccountBasicNav:l.a,modAccountMain:m.a,modAccountSubNavEditProfile:u.a}}},733:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(859),a=s.n(i);t.default={extends:a.a}},859:function(e,t,s){var i=s(0)(s(675),s(905),null,null);e.exports=i.exports},905:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("mod-account-main",{staticClass:"kd-body"},[s("mod-account-basic-nav",[s("router-link",{staticClass:"basic-nav-item",attrs:{tag:"a",to:"/account/setting"}},[e._v("账户设置")]),e._v(" "),s("router-link",{staticClass:"basic-nav-item active",attrs:{tag:"a",to:"/account/edit-profile"}},[e._v("修改资料")]),e._v(" "),s("router-link",{staticClass:"basic-nav-item",attrs:{tag:"a",to:"/account/bank-info"}},[e._v("银行卡信息")])],1),e._v(" "),s("div",{staticClass:"account-body"},[s("mod-account-sub-nav-edit-profile",{staticClass:"mod-secondary-navigation"}),e._v(" "),s("form",{staticClass:"kd-form kd-container",on:{submit:function(e){e.preventDefault()}}},[s("p",{staticClass:"kd-container-tips"},[e._v("* 以下选项均为必填 , 为确保审核通过，请填写有效真实信息！")]),e._v(" "),s("div",{staticClass:"kd-field"},[s("label",{staticClass:"kd-field-title"},[e._v("会员ID")]),e._v(" "),s("div",{staticClass:"kd-field-text"},[e._v(e._s(e.userId?e.userId:"加载中..."))])]),e._v(" "),e.canEditUserName?s("div",{staticClass:"kd-field required"},[s("label",{staticClass:"kd-field-title required"},[e._v("用户名")]),e._v(" "),s("div",{directives:[{name:"textinput",rawName:"v-textinput"}],staticClass:"kd-textinput"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.user.user_name,expression:"user.user_name",modifiers:{trim:!0}},{name:"focus-fixed",rawName:"v-focus-fixed"}],attrs:{type:"text",placeholder:"请输入用户名"},domProps:{value:e.user.user_name},on:{input:function(t){t.target.composing||e.$set(e.user,"user_name",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])]):s("div",{staticClass:"kd-field"},[s("label",{staticClass:"kd-field-title"},[e._v("用户名")]),e._v(" "),s("div",{staticClass:"kd-field-text"},[e._v(e._s(e.userName?e.userName:"加载中..."))])]),e._v(" "),e.canEditMobile?s("div",{staticClass:"kd-field"},[s("label",{staticClass:"kd-field-title"},[e._v("手机号码")]),e._v(" "),s("div",{directives:[{name:"textinput",rawName:"v-textinput"}],staticClass:"kd-textinput"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.user.mobile,expression:"user.mobile",modifiers:{trim:!0}},{name:"focus-fixed",rawName:"v-focus-fixed"}],attrs:{type:"text",placeholder:"请输入手机号码"},domProps:{value:e.user.mobile},on:{input:function(t){t.target.composing||e.$set(e.user,"mobile",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])]):s("div",{staticClass:"kd-field"},[s("label",{staticClass:"kd-field-title"},[e._v("手机号码")]),e._v(" "),s("div",{staticClass:"kd-field-text"},[e._v(e._s(e.mobile||e.user.mobile)+" "),s("span")])]),e._v(" "),s("div",{staticClass:"kd-field"},[s("label",{staticClass:"kd-field-title"},[e._v("姓名")]),e._v(" "),e.canEditName?s("div",{directives:[{name:"textinput",rawName:"v-textinput"}],staticClass:"kd-textinput"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.user.real_name,expression:"user.real_name",modifiers:{trim:!0}},{name:"focus-fixed",rawName:"v-focus-fixed"}],attrs:{type:"text",placeholder:"请输入姓名"},domProps:{value:e.user.real_name},on:{input:function(t){t.target.composing||e.$set(e.user,"real_name",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]):s("div",{staticClass:"kd-field-text"},[e._v(e._s(e.nickName?e.nickName:"加载中..."))])]),e._v(" "),e.introducerId?s("div",{staticClass:"kd-field"},[s("label",{staticClass:"kd-field-title"},[e._v("推荐人ID")]),e._v(" "),s("div",{staticClass:"kd-field-text"},[e._v(e._s(e.introducerId))])]):e._e(),e._v(" "),s("div",{staticClass:"kd-field"},[s("label",{staticClass:"kd-field-title required",attrs:{for:"qq_in_profile"}},[e._v(e._s(e.$labels.qqNumber))]),e._v(" "),e.hasQQ?s("div",{staticClass:"kd-field-text"},[e._v(e._s(e.user.qq?e.user.qq:"加载中...")+" "),s("span")]):s("div",{directives:[{name:"textinput",rawName:"v-textinput"}],staticClass:"kd-textinput"},[s("input",{directives:[{name:"model",rawName:"v-model.trim.number",value:e.user.qq,expression:"user.qq",modifiers:{trim:!0,number:!0}},{name:"focus-fixed",rawName:"v-focus-fixed"}],attrs:{type:"text",placeholder:"请输入常用QQ",id:"qq_in_profile"},domProps:{value:e.user.qq},on:{input:function(t){t.target.composing||e.$set(e.user,"qq",e._n(t.target.value.trim()))},blur:function(t){return e.$forceUpdate()}}})])]),e._v(" "),s("div",{staticClass:"kd-field"},[s("label",{staticClass:"kd-field-title required",attrs:{for:"email_in_profile"}},[e._v("电子邮箱")]),e._v(" "),s("div",{directives:[{name:"textinput",rawName:"v-textinput"}],staticClass:"kd-textinput"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.user.email,expression:"user.email",modifiers:{trim:!0}},{name:"focus-fixed",rawName:"v-focus-fixed"}],attrs:{type:"email",placeholder:"请输入邮箱地址",id:"email_in_profile"},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])])])],1),e._v(" "),s("kd-button",{staticClass:"main-button",on:{click:e.saveProfile}},[s("span",[e._v("保存")])])],1)},staticRenderFns:[]}}});