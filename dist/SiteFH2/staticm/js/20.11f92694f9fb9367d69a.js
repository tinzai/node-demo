webpackJsonp([20],{1011:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("mod-account-main",{staticClass:"kd-body"},[a("mod-account-basic-nav",[a("router-link",{staticClass:"basic-nav-item",attrs:{tag:"a",to:"/account/setting"}},[e._v("账户设置")]),e._v(" "),a("router-link",{staticClass:"basic-nav-item",attrs:{tag:"a",to:"/account/edit-profile"}},[e._v("修改资料")]),e._v(" "),a("router-link",{staticClass:"basic-nav-item active",attrs:{tag:"a",to:"/account/bank-info"}},[e._v("银行卡信息")])],1),e._v(" "),a("div",{staticClass:"account-body"},[a("mod-account-sub-nav-bank-info",{staticClass:"mod-secondary-navigation"}),e._v(" "),a("form",{staticClass:"kd-form kd-container",on:{submit:function(e){e.preventDefault()}}},[a("div",{staticClass:"kd-field"},[a("label",{staticClass:"kd-field-title required",attrs:{for:"nick_name_in_bank_info"}},[e._v(e._s(e.$labels.bankAccountName))]),e._v(" "),e.editablename?a("div",{directives:[{name:"textinput",rawName:"v-textinput"}],staticClass:"kd-textinput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.nickName,expression:"nickName",modifiers:{trim:!0}},{name:"focus-fixed",rawName:"v-focus-fixed"}],attrs:{type:"text",id:"nick_name_in_bank_info",placeholder:"输入中文"},domProps:{value:e.nickName},on:{input:function(t){t.target.composing||(e.nickName=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]):a("div",{staticClass:"kd-field-text"},[e._v(e._s(e.nickName))])]),e._v(" "),a("div",{staticClass:"kd-field"},[a("label",{staticClass:"kd-field-title required",attrs:{for:"card_no_in_bank_info"}},[e._v(e._s(e.$labels.bankCardNo))]),e._v(" "),e.editablenum?a("div",{directives:[{name:"textinput",rawName:"v-textinput"}],staticClass:"kd-textinput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim.lazy",value:e.bankNumber,expression:"bankNumber",modifiers:{trim:!0,lazy:!0}},{name:"focus-fixed",rawName:"v-focus-fixed"}],attrs:{type:"text",id:"card_no_in_bank_info",placeholder:"输入"+e.$labels.bankCardNo},domProps:{value:e.bankNumber},on:{change:[function(t){e.bankNumber=t.target.value.trim()},e.autoSelectBank],blur:function(t){return e.$forceUpdate()}}})]):a("div",{staticClass:"kd-field-text"},[e._v(e._s(e.bankNumber)),a("span")])]),e._v(" "),a("div",{staticClass:"kd-field"},[a("label",{staticClass:"kd-field-title required",attrs:{for:"bank_name_in_bank_info"}},[e._v(e._s(e.$labels.bankName))]),e._v(" "),a("div",{directives:[{name:"select",rawName:"v-select"}],staticClass:"kd-select"},[e.bankName?a("span",{staticClass:"value"},[e._v(e._s(e.bankName))]):a("span",{staticClass:"value",staticStyle:{color:"#999999"}},[e._v(e._s("请选择"+e.$labels.bankName))]),e._v(" "),a("select",{directives:[{name:"model",rawName:"v-model.trim",value:e.bankName,expression:"bankName",modifiers:{trim:!0}},{name:"focus-fixed",rawName:"v-focus-fixed"}],attrs:{id:"bank_name_in_bank_info"},on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.bankName=t.target.multiple?a:a[0]}}},[a("option",{attrs:{value:""}},[e._v(e._s("请选择"+e.$labels.bankName))]),e._v(" "),e._l(e.bankList,function(t){return a("option",{key:t},[e._v(e._s(t))])})],2)])]),e._v(" "),a("div",{staticClass:"kd-field"},[a("label",{staticClass:"kd-field-title required",attrs:{for:"branch_name_in_bank_info"}},[e._v(e._s(e.$labels.bankBranchName))]),e._v(" "),a("div",{directives:[{name:"textinput",rawName:"v-textinput"}],staticClass:"kd-textinput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.branchName,expression:"branchName",modifiers:{trim:!0}},{name:"focus-fixed",rawName:"v-focus-fixed"}],attrs:{type:"text",id:"branch_name_in_bank_info",placeholder:"输入"+e.$labels.bankBranchName+"名称"},domProps:{value:e.branchName},on:{input:function(t){t.target.composing||(e.branchName=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])]),e._v(" "),e.visibleQQ?a("div",{staticClass:"kd-field"},[a("label",{staticClass:"kd-field-title",attrs:{for:"qq_in_bank_info"}},[e._v(e._s(e.$labels.qqNumber)+"：")]),e._v(" "),e.hasQQ?a("div",{staticClass:"kd-field-text"},[e._v(e._s(e.qq))]):a("div",{directives:[{name:"textinput",rawName:"v-textinput"}],staticClass:"kd-textinput"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.qq,expression:"qq",modifiers:{trim:!0}},{name:"focus-fixed",rawName:"v-focus-fixed"}],attrs:{type:"number",id:"qq_in_bank_info",placeholder:"输入"+e.$labels.qqNumber},domProps:{value:e.qq},on:{input:function(t){t.target.composing||(e.qq=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])]):e._e()])],1),e._v(" "),a("kd-button",{staticClass:"main-button",on:{click:e.saveInfo}},[a("span",[e._v("保 存")])])],1)},staticRenderFns:[]}},369:function(e,t,a){var n=a(0)(a(729),null,null,null);e.exports=n.exports},386:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"ComAccountBasicNav"}},387:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"ComAccountBody"}},389:function(e,t){},390:function(e,t){},391:function(e,t){},394:function(e,t,a){a(389);var n=a(0)(a(386),a(397),"data-v-260251c6",null);e.exports=n.exports},395:function(e,t,a){a(390),a(391);var n=a(0)(a(387),a(398),"data-v-e6c6c67e",null);e.exports=n.exports},397:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("ul",{staticClass:"basic-nav clearfix"},[e._t("default")],2)},staticRenderFns:[]}},398:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"com-account-body clearfix"},[e._t("default")],2)},staticRenderFns:[]}},503:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(a(6),a(112)),s=a.n(n);t.default={name:"ComAccountSubNavBankInfo",computed:{hasCashingPassword:function(){return this.$store.state.user.hasCashingPassword}},components:{modAccountSubNav:s.a}}},542:function(e,t,a){var n=a(0)(a(503),a(580),null,null);e.exports=n.exports},580:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("mod-account-sub-nav",{staticClass:"for-bank-info"},[a("router-link",{attrs:{to:"/account/bank-info",tag:"li"}},[a("a",[e._v(e._s(e.$labels.accountBankInfo))])]),e._v(" "),a("router-link",{attrs:{to:"/account/edit-chasing-password",tag:"li"}},[a("a",[e._v(e._s(e.hasCashingPassword?e.$labels.accountEditCashingPassword:e.$labels.accountSetCashingPassword))])])],1)},staticRenderFns:[]}},669:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(6),s=a(542),i=a.n(s),r=a(394),o=a.n(r),c=a(395),u=a.n(c);t.default={name:"PageAccountBankInfo",data:function(){return{editablename:!0,editablenum:!0,nickName:"加载中...",bankNumber:"",bankName:"",branchName:"",bankList:[],qq:"",hasQQ:!1,hasBankName:!1,visibleQQ:!0}},computed:{suggestBankName:function(){var e=this,t="";return this.bankNumber.length&&function(){var a=e.bankNumber.replace(/\s+/g,"");if(a.length){for(var n in e.bankBin){if("break"===function(n){if(e.bankBin[n].split(",").some(function(e){if(e&&RegExp("^"+e).test(a))return t=n,!0}),t)return"break"}(n))break}}}(),t}},created:function(){this.fetchBankInfo(),this.$store.commit("setPage",{pageTitle:this.$labels.accountSetBankInfo,className:"page-account-bank-info"})},methods:{fetchBankInfo:function(){var e=this;return this.$store.dispatch("uFetchBankInfo").then(function(t){e.bankList=t.BankList,e.bankName=t.Bank,e.nickName=t.Name,e.bankNumber=t.Number,e.branchName=t.Detail,e.qq=t.QQ,e.hasQQ=!!t.QQ,e.hasBankName=!!e.bankName&&!!e.branchName,1==t.IsWX?t.Number&&(e.editablenum=!1,e.editablename=!t.Name):t.Name&&(e.editablename=!1,e.editablenum=!t.Number),e.bankBin=t.BankBin?JSON.parse(t.BankBin):{},e.visibleQQ=0!=t.IsShowBankQQ}).catch(function(t){console.log(t),e.$message({message:"获取银行卡信息出错啦！",type:"error",force:!0})})},autoSelectBank:function(){this.bankName=this.suggestBankName},validators:function(){if(""===this.nickName)return this.$message({message:"姓名不能为空!",type:"warning"}),!1;if(this.nickName.length>16||this.nickName.length<2)return this.$message({message:"姓名长度必须在2-16个中文字！",type:"warning"}),!1;if(!/^[\u4e00-\u9fa5]+[·]?[\u4e00-\u9fa5]+[0-9]*$/.test(this.nickName))return this.$message({message:"姓名只能是中文或中文+数字结尾！",type:"warning"}),!1;var e=this.bankNumber.replace(/\s+/g,"").length;if(""===this.bankNumber)return this.$message({message:"银行卡号不能为空！",type:"error"}),!1;if(e<16||e>19)return this.$message({message:"银行卡号无效，必须是16-19位银行卡号！",type:"error"}),!1;if(""===this.bankName)return this.$message({message:"请选择开户银行！",type:"error"}),!1;if(""===this.branchName)return this.$message({message:"开户支行不能为空！",type:"error"}),!1;if(!this.hasQQ&&this.visibleQQ){if(""===this.qq)return this.$message({message:"QQ不能为空!"}),!1;if(/[^\d]/g.test(this.qq))return this.$message({message:"QQ只能是数字！"}),!1;if(this.qq.length>15||this.qq.length<5)return this.$message({message:"标准QQ长度为5-15个数字！"}),!1;if(!/^[1-9][0-9]+$/.test(this.qq))return this.$message({message:"QQ格式不正确！"}),!1}return!0},saveInfo:function(){var e=this;!1!==this.validators()&&n.apiUpdateBankInfoOfUser({Name:this.nickName,Number:this.bankNumber.replace(/\s+/g,""),Bank:this.bankName,QQ:this.qq,Detail:this.branchName}).then(function(e){return e.json()}).then(function(t){"780"===t.S||"900"===t.S?(e.editablename=!1,e.editablenum=!1,e.hasQQ=!0,e.$message({message:t.D||"恭喜你，修改成功！",type:"success",time:1e3,afterClose:function(){"900"===t.S&&e.reInitUser()}})):e.$message({message:t.S+": "+t.D,type:"warning"})}).catch(function(t){console.log(t),e.$message({message:"修改银行卡信息出错啦！",type:"error",force:!0})})},reInitUser:function(){this.$store.dispatch("uFetchInfoOfAuthorizedToLogin",{vm:this}),this.$store.dispatch("uFetchSetting").catch(function(e){console.log(e)}),this.$store.dispatch("uFetchUserInfo",{vm:this}),this.$store.dispatch("uFetchUnredMessagesLength",{vm:this})}},components:{modAccountBasicNav:o.a,modAccountMain:u.a,modAccountSubNavBankInfo:i.a}}},729:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(853),s=a.n(n);t.default={extends:s.a}},853:function(e,t,a){var n=a(0)(a(669),a(1011),null,null);e.exports=n.exports}});